<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ignation Hub | Games</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="../style.css">
    <style>
        .container { max-width: 1200px; margin: 100px auto 50px; padding: 0 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 25px; }
        .game-card { background: var(--panel); border: 1px solid var(--stroke); border-radius: 12px; overflow: hidden; transition: transform 0.4s var(--sine), border-color 0.4s; display: flex; flex-direction: column;}
        .game-card:hover { transform: translateY(-8px); border-color: var(--accent); }
        .game-card img { width: 100%; aspect-ratio: 16/9; object-fit: cover; border-bottom: 1px solid var(--stroke); }
        .card-body { padding: 20px; display: flex; flex-direction: column; flex: 1; }
        .card-body h3 { margin-bottom: 10px; }
        .card-body p { color: #a1a1a1; font-size: 14px; margin-bottom: 20px; height: 42px; line-height: 21px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; mask-image: linear-gradient(to bottom, black 50%, transparent 100%); -webkit-mask-image: linear-gradient(to bottom, black 50%, transparent 100%); }
        .btn-group { display: flex; gap: 10px; margin-top: auto; position: relative; z-index: 2; }
        .btn { flex: 1; padding: 12px; font-size: 13px; justify-content: center;}
        .btn-copy { background: #2a2b33; border: 1px solid var(--stroke); }
        .btn-play { background: var(--accent); border: 1px solid var(--accent); }
        
        #notification-container { position: fixed; bottom: 30px; right: 30px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
        .popup { background: #000; border-radius: 8px; padding: 15px 25px; display: flex; align-items: center; gap: 15px; min-width: 300px; transform: translateX(120%); transition: transform 0.5s var(--sine); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .popup.show { transform: translateX(0); }
        .popup.success { border: 1px solid var(--success); box-shadow: 0 0 15px rgba(34, 197, 94, 0.2); }
        .popup.error { border: 1px solid var(--error); box-shadow: 0 0 15px rgba(239, 68, 68, 0.2); }
        .popup i { font-size: 20px; }
        .popup.success i { color: var(--success); }
        .popup.error i { color: var(--error); }
    </style>
</head>
<body>
    <nav>
        <a href="../" class="logo-area">
            <img src="https://github.com/BlackfireSoon/BlackfireSoon.github.io/blob/main/assets/ignIcon.png?raw=true" alt="Ignation">
            <b>IGNATION HUB</b>
        </a>
        <div class="nav-links">
            <a href="../uilib/">UI Library</a>
            <a href="../games/" class="active">Games</a>
            <a href="../community/">Community</a>
            <a href="../plus/">Plus</a>
        </div>
    </nav>

    <div class="container">
        <div class="grid" id="gameGrid"></div>
    </div>
    <div id="notification-container"></div>

    <script>
        const USER = "BlackfireSoon"; const REPO = "Ignation-Hub";

        function showPopup(message, type) {
            const container = document.getElementById('notification-container');
            const popup = document.createElement('div');
            const icon = type === 'success' ? 'check-circle' : 'alert-circle';
            popup.className = `popup ${type}`;
            popup.innerHTML = `<i data-lucide="${icon}"></i> <span>${message}</span>`;
            container.appendChild(popup);
            lucide.createIcons();
            setTimeout(() => popup.classList.add('show'), 10);
            setTimeout(() => { popup.classList.remove('show'); setTimeout(() => popup.remove(), 500); }, 3000);
        }

        async function loadGames() {
            try {
                const resp = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/games`);
                const items = await resp.json();
                for (const item of items) { if (item.type === 'dir') renderGame(item.name); }
            } catch (e) { showPopup("Failed to reach GitHub API", "error"); }
        }

        async function renderGame(id) {
            const grid = document.getElementById('gameGrid');
            const infoUrl = `https://raw.githubusercontent.com/${USER}/${REPO}/main/games/${id}/info.json`;
            const scriptUrl = `https://raw.githubusercontent.com/${USER}/${REPO}/main/games/${id}/index.luau`;
            let meta = { title: `ID: ${id}`, description: "Standard Ignation Script", thumbnail: `https://assetgame.roblox.com/Game/Tools/ThumbnailAsset.ashx?assetId=${id}&width=768&height=432&format=png` };

            try { const res = await fetch(infoUrl); if(res.ok) Object.assign(meta, await res.json()); } catch(e) {}

            const card = document.createElement('div'); card.className = 'game-card';
            card.innerHTML = `
                <img src="${meta.thumbnail}" alt="Game">
                <div class="card-body">
                    <h3>${meta.title}</h3>
                    <p>${meta.description}</p>
                    <div class="btn-group">
                        <button class="btn btn-copy" onclick="copy('${scriptUrl}')"><i data-lucide="copy"></i> Copy</button>
                        <a href="https://www.roblox.com/games/${id}" target="_blank" class="btn btn-play"><i data-lucide="external-link"></i> Play</a>
                    </div>
                </div>`;
            grid.appendChild(card); lucide.createIcons();
        }

        async function copy(url) {
            try {
                await navigator.clipboard.writeText('loadstring(game:HttpGet("https://raw.githubusercontent.com/BlackfireSoon/Ignation-Hub/refs/heads/main/main.luau"))()');
                showPopup("Script copied to clipboard!", "success");
            } catch(e) { showPopup("Failed to copy script.", "error"); }
        }
        loadGames();
    </script>
</body>
</html>
